<!-- begin panel -->
<div class="panel panel-inverse">

  <!-- begin panel-heading -->
  <div class="panel-heading">
    <div class="panel-heading-btn">
      <a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-default" panel-expand><i class="fa fa-expand"></i></a>
      <a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-default" panel-reload><i class="fa fa-redo"></i></a>
      <a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-default" panel-collapse><i class="fa fa-minus"></i></a>
      <a href="javascript:;" class="btn btn-xs btn-icon btn-circle btn-danger" panel-remove><i class="fa fa-times"></i></a>
    </div>
    <h4 class="panel-title height-20">Form</h4>
  </div>
  <!-- end panel-heading -->

  <!-- begin panel-body -->
  <div class="panel-body">

    <form class="form-horizontal form-bordered" name="vm.form.paymentForm" novalidate autocomplete="off">

      <div class="alert alert-secondary fade show">
        <span class="text-danger f-s-15">*</span> Member information.
      </div>


      <div class="form-group row">
        <label class="col-form-label col-lg-2 bg-silver-lighter">Providers</label>
        <div class="col-lg-4">
          <span provider>{{vm.member.providers[0]}}</span>
        </div>
      </div>

      <div class="form-group row">
        <label class="col-form-label col-lg-2 bg-silver-lighter">Username</label>
        <div class="col-lg-4">
          {{vm.member.username}}
        </div>
      </div>

      <div class="form-group row" ng-if="vm.member">
        <label class="col-form-label col-lg-2 bg-silver-lighter">Korean Name</label>
        <div class="col-lg-4">
          {{vm.member.koreanName}}
        </div>

        <label class="col-form-label col-lg-2 bg-silver-lighter">English Name</label>
        <div class="col-lg-4">
          {{vm.member.englishName}}
        </div>
      </div>

      <div class="form-group row" ng-if="vm.member">
        <label class="col-form-label col-lg-2 bg-silver-lighter">Mobile</label>
        <div class="col-lg-4">
          {{vm.member.mobile | mobile}}
        </div>

        <label class="col-form-label col-lg-2 bg-silver-lighter">E-mail</label>
        <div class="col-lg-4">
          {{vm.member.email}}
        </div>
      </div>

      <div class="alert alert-secondary fade show m-t-20">
        <span class="text-danger f-s-15">*</span> Product search filter.
      </div>

      <div class="form-group row">
        <label class="col-form-label col-lg-2 bg-silver-lighter">Product Type</label>
        <div class="col-lg-4">

          <select class="form-control form-control-sm" chosen ng-model="vm.search.productType" ng-change="vm.figureOutProduct()">
            <option value="">Product Type...</option>
            <option value="telephone">Telephone</option>
            <option value="skype">Skype</option>
            <option value="screenBoard">Screen Board</option>
          </select>
        </div>
      </div>

      <div class="form-group row">
        <label class="col-form-label col-lg-2 bg-silver-lighter">Curriculum</label>
        <div class="col-lg-4">

          <select class="form-control form-control-sm" chosen ng-model="vm.search.curriculum" ng-change="vm.figureOutProduct()">
            <option value="">Curriculum...</option>
            <option value="conversation">Conversation</option>
            <option value="freeTalking">Free Talking</option>
            <option value="business">Business</option>
            <option value="interview">Interview</option>
            <option value="examPreparation">Exam Preparation</option>
          </select>
        </div>

        <label class="col-form-label col-lg-2 bg-silver-lighter">Nation</label>
        <div class="col-lg-4">

          <select class="form-control form-control-sm" chosen ng-model="vm.search.nation" ng-change="vm.figureOutProduct()">
            <option value="">Nation...</option>
            <option value="bulgaria">Bulgaria</option>
            <option value="philippines">Philippines</option>
            <option value="northAmerica">North America</option>
          </select>
        </div>
      </div>


      <div class="form-group row">
        <label class="col-form-label col-lg-2 bg-silver-lighter">Month</label>
        <div class="col-lg-4">

          <select class="form-control form-control-sm" chosen ng-model="vm.search.month" ng-change="vm.figureOutProduct()">
            <option value="">Month...</option>
            <option value="1">1 Month</option>
            <option value="3">3 Month</option>
            <option value="6">6 Month</option>
            <option value="12">12 Month</option>
          </select>
        </div>
      </div>

      <div class="form-group row">
        <label class="col-form-label col-lg-2 bg-silver-lighter">Times</label>
        <div class="col-lg-4">

          <select class="form-control form-control-sm" chosen ng-model="vm.search.times" ng-change="vm.figureOutProduct()">
            <option value="">Times...</option>
            <option value="2">2 Times</option>
            <option value="3">3 Times</option>
            <option value="5">5 Times</option>
          </select>
        </div>

        <label class="col-form-label col-lg-2 bg-silver-lighter">Minutes</label>
        <div class="col-lg-4">

          <select class="form-control form-control-sm" chosen ng-model="vm.search.minutes" ng-change="vm.figureOutProduct()">
            <option value="">Minutes...</option>
            <option value="10">10 Minutes</option>
            <option value="20">20 Minutes</option>
          </select>
        </div>
      </div>


      <div class="alert alert-secondary fade show m-t-20">
        <span class="text-danger f-s-15">*</span> Product's <a ui-sref="resource.product.modify({productId: vm.product._id})">{{vm.product.title}}</a> information.
      </div>


      <div class="form-group row" show-errors>
        <label class="col-form-label col-lg-2 bg-silver-lighter"><span class="text-danger">*</span>Product Title
          <span class="text-danger">({{vm.filteredItems.length}})</span>
        </label>
        <div class="col-lg-4 form-chosen-up">

          <select class="form-control form-control-sm" name="product" chosen ng-model="vm.product" ng-options="product.title for product in vm.filteredItems" ng-change="vm.changeProduct(vm.product)" required>
            <option disabled value="">Product...</option>
          </select>

          <div ng-messages="vm.form.paymentForm.product.$error" role="alert">
            <p class="help-block error-text" ng-message="required">Product is required.</p>
          </div>
        </div>
      </div>


      <div ng-if="vm.product">

        <div class="form-group row">
          <label class="col-form-label col-lg-2 bg-silver-lighter">Product Type</label>
          <div class="col-lg-4">
            <span product-type>{{vm.product.productType}}</span>
          </div>
        </div>

        <div class="form-group row">
          <label class="col-form-label col-lg-2 bg-silver-lighter">Curriculum</label>
          <div class="col-lg-4">
            <span class="label label-default">{{vm.product.curriculum | capitalize}}</span>
          </div>

          <label class="col-form-label col-lg-2 bg-silver-lighter">Tutor Nation</label>
          <div class="col-lg-4">
            <span class="label label-default">
              <h6 class="flag-icon flag-icon-{{vm.product.nationCode | lowercase}}"></h6>
              {{vm.product.nation | capitalize}}
            </span>

          </div>
        </div>

        <div class="form-group row">
          <label class="col-form-label col-lg-2 bg-silver-lighter">Month</label>
          <div class="col-lg-4">
            {{vm.product.month}} Month
          </div>
        </div>

        <div class="form-group row">
          <label class="col-form-label col-lg-2 bg-silver-lighter">Times</label>
          <div class="col-lg-4">
            {{vm.product.times}} Times
          </div>

          <label class="col-form-label col-lg-2 bg-silver-lighter">Minutes</label>
          <div class="col-lg-4">
            {{vm.product.minutes}} Min
          </div>
        </div>

        <div class="form-group row">
          <label class="col-form-label col-lg-2 bg-silver-lighter">Lesson
            <span ng-class="{
              'text-success': vm.payment.subLessonCount > vm.product.lessonCount,
              'text-danger': vm.payment.subLessonCount < vm.product.lessonCount
            }">({{vm.payment.subLessonCount - vm.product.lessonCount}})
            </span>
          </label>
          <div class="col-lg-4">
            <input type="number" class="form-control form-control-sm" ng-model="vm.payment.subLessonCount" />
          </div>
        </div>

        <div class="form-group row">
          <label class="col-form-label col-lg-2 bg-silver-lighter">Postpone
            <span ng-class="{
              'text-success': vm.payment.subPostponeCount > vm.product.postponeCount,
              'text-danger': vm.payment.subPostponeCount < vm.product.postponeCount
            }">({{vm.payment.subPostponeCount - vm.product.postponeCount}})
            </span>
          </label>
          <div class="col-lg-4">
            <input type="number" class="form-control form-control-sm" ng-model="vm.payment.subPostponeCount" />
          </div>
        </div>

        <div class="form-group row">
          <label class="col-form-label col-lg-2 bg-silver-lighter">Original Price</label>
          <div class="col-lg-4">
            {{vm.product.price | currency : '₩' : 0}}
          </div>

          <label class="col-form-label col-lg-2 bg-silver-lighter">Discount Price Rete</label>
          <div class="col-lg-4">
            {{vm.product.discountPriceRate}} %
          </div>
        </div>

        <div class="form-group row">
          <label class="col-form-label col-lg-2 bg-silver-lighter">Sub Price</label>
          <div class="col-lg-4">
            {{vm.product.subPrice | currency : '₩' : 0}}
          </div>

        </div>
      </div>

      <div ng-if="vm.product">
        <div class="alert alert-secondary fade show m-t-20">
          Payment information. You can change <strong>points</strong> and <strong>coupons</strong> set by member.
        </div>

        <div class="form-group row" show-errors>
          <label class="col-form-label col-lg-2 bg-silver-lighter"><span class="text-danger">*</span>Desired Start Datetime of Lesson</label>
          <div class="col-lg-4">
            <div class="input-group input-group-sm date" name="desired" datetimepicker ng-model="vm.payment.desired" options="vm.datetimePickerOptions">
              <input type="text" class="form-control form-control-sm" required />
              <div class="input-group-addon">
                <i class="fa fa-calendar"></i>
              </div>
            </div>
            <div ng-messages="vm.form.paymentForm.desired.$error" role="alert">
              <p class="help-block error-text" ng-message="required">desired start datetime of lesson is required.</p>
            </div>
          </div>
        </div>


        <div class="form-group row" show-errors>
          <label class="col-form-label col-lg-2 bg-silver-lighter">
            Point<span ng-class="text-primary">({{vm.member.point - vm.point}})</span>
          </label>
          <div class="col-lg-4">
            <input type="number" class="form-control form-control-sm" name="point" ng-model="vm.point" ng-max="vm.member.point" ng-change="vm.calTotalPrice()" ng-disabled="!vm.payment.method" />
            <div ng-messages="vm.form.paymentForm.point.$error" role="alert">
              <p class="help-block error-text" ng-message="max">Point is max.</p>
            </div>
          </div>
        </div>

        <div class="form-group row">
          <label class="col-form-label col-lg-2 bg-silver-lighter">
            Coupon<span ng-class="text-primary">({{vm.member.coupons.length}})</span>
          </label>
          <div class="col-lg-4 form-chosen-up">
            <select class="form-control form-control-sm" chosen ng-model="vm.coupon" ng-options="coupon.displayAmount for coupon in vm.member.coupons" ng-change="vm.calTotalPrice()" ng-disabled="!vm.payment.method">
              <option value="">Coupon...</option>
            </select>
          </div>
        </div>



        <div class="form-group row" show-errors>
          <label class="col-form-label col-lg-2 bg-silver-lighter">Payment Method</label>
          <div class="col-lg-10">

            <div class="radio radio-css radio-inline">
              <input type="radio" name="method" id="DWB" value="DWB" ng-model="vm.payment.method" ng-change="vm.changePaymentMethod(vm.payment.method)" checked required />
              <label for="DWB">DWB</label>
            </div>
            <div class="radio radio-css radio-inline">
              <input type="radio" name="method" id="CC" value="CC" ng-model="vm.payment.method" ng-change="vm.changePaymentMethod(vm.payment.method)" required />
              <label for="CC">CC</label>
            </div>
            <div class="radio radio-css radio-inline">
              <input type="radio" name="method" id="AT" value="AT" ng-model="vm.payment.method" ng-change="vm.changePaymentMethod(vm.payment.method)" required />
              <label for="AT">AT</label>
            </div>
            <div class="radio radio-css radio-inline">
              <input type="radio" name="method" id="ARS" value="ARS" ng-model="vm.payment.method" ng-change="vm.changePaymentMethod(vm.payment.method)" required />
              <label for="ARS">ARS</label>
            </div>
            <div class="radio radio-css radio-inline">
              <input type="radio" name="method" id="PAYUP" value="PAYUP" ng-model="vm.payment.method" ng-change="vm.changePaymentMethod(vm.payment.method)" required />
              <label for="PAYUP">PAYUP</label>
            </div>

            <div ng-messages="vm.form.paymentForm.method.$error" role="alert">
              <p class="help-block error-text" ng-message="required">Payment method is required.</p>
            </div>
          </div>
        </div>


        <div class="form-group row">
          <label class="col-form-label col-lg-2 bg-silver-lighter">DWB <small>(Deposit Without Bankbook)</small> Price</label>
          <div class="col-lg-4">
            <input type="number" class="form-control form-control-sm" ng-model="vm.payment.dwbPrice" ng-change="vm.calTotalPrice()" />
          </div>
        </div>

        <div class="form-group row">
          <label class="col-form-label col-lg-2 bg-silver-lighter">CC <small>(Credit Card)</small> Price</label>
          <div class="col-lg-4">
            <input type="number" class="form-control form-control-sm" ng-model="vm.payment.ccPrice" ng-change="vm.calTotalPrice()" />
          </div>
        </div>

        <div class="form-group row">
          <label class="col-form-label col-lg-2 bg-silver-lighter">AT <small>(Account Transfer)</small> Price</label>
          <div class="col-lg-4">
            <input type="number" class="form-control form-control-sm" ng-model="vm.payment.atPrice" ng-change="vm.calTotalPrice()" />
          </div>
        </div>

        <div class="form-group row">
          <label class="col-form-label col-lg-2 bg-silver-lighter">ARS Price</label>
          <div class="col-lg-4">
            <input type="number" class="form-control form-control-sm" ng-model="vm.payment.arsPrice" ng-change="vm.calTotalPrice()" />
          </div>
        </div>

        <div class="form-group row">
          <label class="col-form-label col-lg-2 bg-silver-lighter">PAYUP <small>(Pay-Up)</small> Price</label>
          <div class="col-lg-4">
            <input type="number" class="form-control form-control-sm" ng-model="vm.payment.payupPrice" ng-change="vm.calTotalPrice()" />
          </div>
        </div>

        <div class="form-group row">
          <label class="col-form-label col-lg-2 bg-silver-lighter">Total Price
            <span ng-class="{
              'text-primary': vm.payment.totalPrice > vm.product.subPrice,
              'text-danger': vm.payment.totalPrice < vm.product.subPrice
            }">{{vm.payment.totalPrice - vm.product.subPrice | currency : '₩' : 0}}</span>
          </label>
          <div class="col-lg-4">
            <input type="number" class="form-control form-control-sm" ng-model="vm.payment.totalPrice" disabled />
          </div>
        </div>

      </div>

    </form>
  </div>
  <!-- end panel-body -->

  <!-- begin panel-footer -->
  <div class="panel-footer text-right">
    <button ui-sref="member.view.payment.list" class="btn btn-white btn-sm"><i class="fas fa-long-arrow-alt-left"></i> Back</button>
    <button ng-click="vm.virtualPayment(vm.form.paymentForm.$valid)" class="btn btn-primary btn-sm"><i class="fas fa-check"></i> Submit</button>
  </div>
  <!-- end panel-footer -->
</div>
<!-- end panel -->
